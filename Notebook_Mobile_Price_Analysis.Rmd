---
title: "Analyse Data Set Mobile Price"
output: html_notebook
---

Initialisation et import des données

```{r}
install.packages("tidyverse")
install.packages("pacman")

library(tidyverse)

fig <- function(width, heigth){
     options(repr.plot.width = width, repr.plot.height = heigth)
}

library(pacman)

pacman::p_load(pacman,dplyr, ggplot2, rio, gridExtra, scales, ggcorrplot, caret, e1071)

dataSet <- read.csv('data/train.csv')
```


```{r}
names(dataSet)
```

Affichage du set de données.

Colonnes : battery_power, blue, clock_speed, dual_sim, fc, four_g,int_memory, m_dep, mobile_wt, n_cores, pc, px_height, px_width, ram, sc_h, sc_w, talk_time, three_g, touch_screen, wifi, price_range

battery_power:Total energy a battery can store in one time measured in mAh
blue:Has bluetooth or not
clock_speed:speed at which microprocessor executes instructions
dual_sim:Has dual sim support or not
fc:Front Camera mega pixels
four_g:Has 4G or not
int_memory:Internal Memory in Gigabytes
m_dep:Mobile Depth in cm
mobile_wt:Weight of mobile phone
n_cores:Number of cores of processor
pc:Primary Camera mega pixels
px_height:Pixel Resolution Height
px_width:Pixel Resolution Width
ram:Random Access Memory in Megabytes
sc_h:Screen Height of mobile in cm
sc_w:Screen Width of mobile in cm
talk_time:longest time that a single battery charge will last when you are
three_g:Has 3G or not
touch_screen:Has touch screen or not
wifi:Has wifi or not
price_range: This is the target variable with value of 0(low cost), 1(medium cost), 2(high cost) and 3(very high cost).

```{r}
dim(dataSet)
class(dataSet)
head(dataSet)
sapply(dataSet, class)
```


```{r}
summary(dataSet)
```


```{r}
library(ggcorrplot)
corr <- round(cor(dataSet), 8)
ggcorrplot(corr)
fig(18, 16)
```


```{r}
str(dataSet)
```


```{r}
dataSet$price_range <- as.factor(dataSet$price_range)
```


```{r}
prop.table(table(dataSet$blue)) # cell percentages
prop.table(table(dataSet$dual_sim)) # cell percentages
prop.table(table(dataSet$four_g)) # cell percentages
prop.table(table(dataSet$three_g)) # cell percentages
prop.table(table(dataSet$touch_screen)) # cell percentages
prop.table(table(dataSet$wifi)) # cell percentages
```

Subplots using filtered dataset
```{r}
library(ggplot2)
library(gridExtra)
p1 <-  ggplot(dataSet, aes(x=px_width, y = px_height, color=price_range)) +
  geom_boxplot(outlier.colour="red", outlier.shape=8,
               outlier.size=4) +
  labs(title = "Pixel Resolution Height vs Pixel Resolution Width")
p2 <- ggplot(dataSet, aes(x=price_range, y = ram, color=price_range)) +
  geom_boxplot(outlier.colour="red", outlier.shape=8,
               outlier.size=4) +
  labs(title = "RAM vs Price Range")
p3 <- ggplot(dataSet, aes(x=price_range, y = four_g, color=price_range)) +
  geom_boxplot(outlier.colour="red", outlier.shape=8,
               outlier.size=4) +
  labs(title = "4G vs Price Range")
grid.arrange(p1, p2, p3,nrow = 1)
fig(18, 16)
```


```{r}
library(ggplot2)
data = data.frame(Dimensions_in_cm = c(dataSet$sc_h, dataSet$sc_w), 
               Screen = rep(c("Height", "Width"), c(length(dataSet$sc_h), length(dataSet$sc_w))))
ggplot(data, aes(Dimensions_in_cm, fill = Screen)) + 
  geom_bar(position = 'identity', alpha = .6)

fig(18, 16)
```


```{r}
df <- data.frame(
  group = c(0, 1, 2, 3),
  value = c(sum(dataSet$price_range==0), sum(dataSet$price_range==1), sum(dataSet$price_range==2), sum(dataSet$price_range==3))
  )

bp<- ggplot(df, aes(x="", y=value, fill=group))+
geom_bar(width = 1, stat = "identity")
bp
pie <- bp + coord_polar("y", start=0)
pie
fig(18, 16)
```

```{r}
forPriceRange0 %>% filter(dataSet$price_range == 0)
forPriceRange1 %>% filter(dataSet$price_range == 1)
forPriceRange2 %>% filter(dataSet$price_range == 2)
forPriceRange3 %>% filter(dataSet$price_range == 3)
mean(forPriceRange0$battery_power)
```

